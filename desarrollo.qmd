---
title: "Propuesta de adaptaci칩n BD masiva a desarrollo actual del m칩dulo de campa침as"
author: "Illak Zapata"
format: 
  html:
    toc: true
    toc-location: left
    theme: 
      light: flatly
      dark: darkly
editor: source
lang: es
---

## ETL

Para la generaci칩n de la BD de mails masiva se llev칩 a cabo una tarea de
ETL (Extracci칩n, transformaci칩n, carga) de datos.

* **Extracci칩n** de datos de mails (y otros atributos) de las distintas
fuentes existentes y presentadas.
* **Transformaci칩n** de los datos que implica la limpieza y procesamiento
de los mismos, por ejemplo normalizaci칩n de atributos, verificaci칩n
de mail, etc.
* **Carga** de los datos transformados y unificados en una tabla
(con esquema desnormalizado), en donde los mails son un 칤ndice 칰nico.


DIAGRAMAS

AUTOMATIZACI칍N C칍MO TAREA FALTANTE

## Conjuntos de destinatarios

De acuerdo a los requerimientos que nos pasaron en su momento, debemos
considerar los siguientes conjuntos de destinatarios:

* Inspectores generales y supervisores de nivel Inicial
* Directores de escuelas de niveles Inicial
* Inspectores generales y supervisores de nivel Primario
* Directores de escuelas de niveles Primario
* Inspectores generales y supervisores de nivel Secundario
* Directores de escuelas de niveles Secundario
* Inspectores generales y supervisores de nivel Superior
* IFD p칰blicos de toda la provincia (se pueden segregar por departamento, ciudad y carreras que dictan)
* IFD privados de toda la provincia (se pueden segregar por departamento, ciudad y carreras que dictan)
* Base de ingl칠s: todas las personas que tengan cargado que dan ingl칠s en nuestra base de datos; todos los profes que dan ingl칠s en Jornada Extendida (base externa); toda la gente de la comunidad de pr치cticas que de ingl칠s; toda la gente que se curs칩 los Ateneos de ingl칠s; todas las personas que se anotaron a conversatorios de ingl칠s; todas las bases de datos que tengan el programa Entre Lenguas. 
* Base masiva: armar una nueva que traiga: personas (autogesti칩n), inscriptos a eventos (no repetidos en Personas); personas que se suscriben en el portal y HE; bases de datos externas (supervisores, directores de escuelas).
* Base HE, separada por niveles. Todos los que se suscribieron de acuerdo al nivel que hayan indicado; todas las personas de la base ISEP de la que podemos rastrear el nivel de desempe침o.


Por orden de prioridad y necesidad, arrancaremos por el grupo 
destinatario m치s grande: **destinatarios para campa침as masivas**.

## Destinatarios para campa침as masivas

De acuerdo a lo anterior, se pide que el listado de destinatarios est칠
conformado por:

>personas (autogesti칩n), inscriptos a eventos (no repetidos en Personas); personas que se suscriben en el portal y HE; bases de datos externas (supervisores, directores de escuelas).

Pero antes repasemos la consulta que actualmente est치 siendo utilizada
para este tipo de campa침as:

```sql


SELECT `dni`, `nombre`, `apellido`, `emails` as `email1`, 
'' as email2, `email_gapp`, `personas`.`idpersona` as `p_idpersona`, 
0 as `c_idmatriculacion`

FROM `personas`
WHERE `emails` NOT IN (select email1 from mailing_altasbajas where tipo="baja")
AND `email_gapp` NOT IN (select email1 from mailing_altasbajas where tipo="baja")
AND personas.idpersona NOT IN (SELECT `idpersona`
FROM `mailing_destinatarios`
WHERE `idcampania` = '1956') 

union 

SELECT '' as dni, `nombre` as `nombre`, `apellido` as `apellido`, 
`email1` as `email1`, `email2` as `email2`, '' as email_gapp, 
0 as `p_idpersona`, 0 as `c_idmatriculacion`
FROM `mailing_altasbajas`
WHERE `tipo` = 'alta'
AND `categoria` = 'Suscripci칩n voluntaria'
AND `email1` NOT IN (select email1 from mailing_altasbajas where tipo="baja")

```


::: {.callout-note}
Como se puede observar, esta consulta 칰nicamente considera el grupo de
personas de autogesti칩n y suscripciones voluntarias, haciendo que
el "alcance" o "llegada" sea menor a lo que se propone en este tipo
de campa침as "masivas". Por otro lado como se analiz칩 en su momento,
칰nicamente (y mayoritariamente) se est치 llegando a docentes que ya 
han interactuado con al menos una propuesta en el ISEP.
:::

A continuaci칩n se indica la disponibilidad de cada una de las columnas en
la nueva BD de mails:

* `dni` (s칩lo si se tiene el dato de la fuente de origen, por ejemplo, las cuentas que se obtienen de autogesti칩n s칤 cuentan con este campo)
* `nombre` (casi siempre, 칤dem `dni`)
* `apellido` (casi siempre, 칤dem `dni`)
* `email1` (se hace la suposici칩n de que este campo es el "mail personal",
siempre va a estar disponible)
* `email2` (al parecer este campo no se utiliza)
* `email_gapp` (el correo institucional, s칩lo para personas que han
interactuado con alguna propuesta del ISEP)
* `p_idpersona` (칤dem `email_gapp`, este campo actualmente no existe en
la BD de mails, se puede considerar sumar este atributo, pero... 
*쯥e utiliza?*)
* `c_idmatriculacion` (al parecer este campo no se utiliza)

En base a lo anterior debemos analizar tambi칠n qu칠 campos se pueden "quitar"
en la nueva consulta y cuales permanecen. Para esto debemos evaluar si el
m칩dulo "exige" la existencia de ciertos atributos o no:

* 쮺u치les son obligatorios?
* 쮻e cu치les podemos prescindir?
* 쯃as campa침as masivas hacen uso de todos esos atributos? 쯉e usa el nombre?
쯉e usa el apellido?

A veces este tipo de preguntas sumadas a la propuesta de un esquema nuevo de
BD, nos llevan a evaluar la necesidad de agregar nueva l칩gica o bien,
modificar la actual, c칩mo por ejemplo para el caso del atributo nombre:


```{mermaid}
%%| fig-align: center
flowchart LR
  C{"쯊engo el dato del nombre?"}
  C-- S칤 -->D["Estimado {nombre}, ..."]
  C-- No -->E["Estimado docente, ..."]
```


Esto, al momento de "renderizar" la plantilla o cuerpo del mail con los
datos correspondientes. Pero obviamente esto queda sujeto a debate.

Volviendo al caso, la fuente de mails masiva tiene la particularidad de
que podemos agrupar cuentas por DNI pero, como se indic칩 anteriormente,
este atributo no figura en **todas** las fuentes originales. Debido a esto
se proponen dos grupos que luego ser치n unificadas.

* Con el dato DNI: se agrupan las cuentas en base a este atributo para 
identificar aquellas que pertenecen a una misma persona. Este grupo
contempla (o contiene) las cuentas de personas que han pasado por 
el ISEP, es decir, contiene en su mayor칤a al conjunto de cuentas que 
estaba siendo utilizado en las campa침as masivas hacia finales del 2023. 
Pero tambi칠n pueden ser cuentas de personas que no interactuaron con 
el ISEP y por lo tanto no tienen el dato de cuenta institucional, 
pero s칤 el personal.
* Sin el dato DNI: lo que se considera como "el resto". Cuentas de otras
fuentes que no contengan el dato de DNI y que, por lo tanto, no podemos
identificar la persona a la que pertenece y de esta forma agruparlos.

Recordemos que ya que la *fuente de mails* tiene como base la caracter칤stica
de *unicidad* en las cuentas de correo, sabemos que en los grupos que
se generen **no va a haber cuentas repetidas** (tanto al interior como
entre grupos).
Ojo!! que esto no nos asegura que un mail que exista en el segundo grupo 
no pertenezca a una persona del primero pero al 
**no tener el dato de DNI**, no lo podremos saber.

::: {.callout-note}
El autor considera que no tiene sentido armar una **heur칤stica** avanzada
que permita unificar mails en base a otros atr칤butos ya que es un 
trabajo que lleva su tiempo y esto s칩lo justifica un esquema en que los
registros son **personas 칰nicas**.

Para el autor, cada registro en la BD masiva es una **cuenta de correo 
칰nica** con los atributos que hacen de metadato para conocer un poco m치s
sobre el origen de la cuenta. De esta forma, se puede decidir c칩mo proceder
en agrupar o generar "bolsas" de cuentas a las cuales enviar campa침as.

Es una de las tantas formas de abstraer el problema.
:::

::: {.callout-important}
El desarrollo de la fuente de mails masiva, contempla la idea GIGO
(garbage IN, garbage OUT), "*basura entra, basura sale*". En ese sentido
si la fuente de origen tiene errores o inconsistencias, las mismas se ver치n
reflejadas en las fuentes resultantes (o anal칤ticas). Esto viene al caso
por un error que se detect칩 hace poco sobre dos persona (de 
la tabla `personas`, fuente de origen) que compart칤an el mismo DNI. 
Esto se vi칩 reflejado en la BD de mails ya que no permite identificar
a qu칠 persona corresponde la cuenta y por lo tanto el proceso de 
unificar resuelve de manera err칩nea para estas dos cuentas.

El desarrollo de este tipo de fuentes o *data warehouses*, generalmente
considera que las fuentes de origen son lo suficientemente robustas,
consistentes y entonces s칩lo se enfoca el trabajo en normalizar o 
limpiar datos, pero no en corregirlos.
:::


### Grupo 1

Tomando como referencia las columnas de la consulta actual para
destinatarios de campa침as masivas:

```sql

-- REGISTROS QUE CUENTAN CON EL DATO DE DNI
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
GROUP BY mas.dni;

```
hemos conservado los mismos campos pero con algunas consideraciones:

* `p_idpersona` ahora es `NULL`
* `c_idmatriculacion` ahora es `NULL`

Por otro lado, como se puede notar en los primeros registros que devuelve la consulta:

![primeros registros de la consulta para el grupo 1](imgs/grupo_1_email_gapp.png)

algunos DNI tienen un formato incorrecto: algunos con pocos
d칤gitos, en otros todos los d칤gitos son cero, otros empiezan por cero, etc.
Esto es consecuencia de la idea *GIGO* (basura entra, basura sale). Las
fuentes de origen tienen el dato de DNI mal formateado, sin verificaci칩n,
etc. Sin embargo el mail asociado (el personal) es correcto (al menos
estructuralmente o en t칠rminos de sintaxis). A ra칤z de esto se recomienda
revisar las reglas de verificaci칩n en las distintas fuentes que admiten 
el dato de DNI a partir de **formularios**. Por otro lado se puede revisar 
el **tipo de dato** en las tablas de la BD.


Se proponen 2 opciones:

1. Se deja tal como est치: sabemos que la cuenta est치 bien y el campo DNI no
es relevante en el env칤o de campa침as, s칩lo es 칰til para **agrupar** cuentas
asociadas a una misma persona. Esto se corrige autom치ticamente, al corregir
la fuente de origen (GIGO).
2. Se hace un filtro posterior, dejando 칰nicamente los registros con el campo DNI "correcto". Esto va acorde a la "cultura" del parche constante.

En este caso se procede con la opci칩n n칰mero 1.


### Grupo 2

Similar al *Grupo 1* pero notar que cambia el `WHERE` y ya no se agrupan
registros.

```sql

-- REGISTROS QUE NO CUENTAN CON EL DATO DE DNI
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si";

```

Este grupo contiene muchos menos registros que el primero. 
Algunas observaciones:

* Ning칰n registro tiene el dato de `email_gapp` (o cuenta institucional).
* Se puede observar que varios registros no tienen el dato de *Nombre* y/o
*Apellido*. Esto se debe a las fuentes de origen que mayormente "alimentan"
a este grupo (fuentes externas a la de `personas` en donde 
nombre/apellido/dni no parecen ser datos relevantes).


### Unificaci칩n de grupos 

Finalmente se procede con la uni칩n de ambos grupos para construir
la consulta definitiva de destinatarios de **campa침as masivas**:


```sql

-- GRUPO 1
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
GROUP BY mas.dni

UNION

-- GRUPO 2
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si";

```

## Grupos destinatarios espec칤ficos

Para todos estos grupos, se aprovechan los distintos atributos de la 
fuente de mails masiva. Esto se ver치 reflejado en la parte 
del `WHERE` en las siguientes consultas.


### Inspectores generales y supervisores de nivel Inicial

En este caso se filtran:

* cuentas que provienen de la fuente de supervisores `sup`
* adem치s que sean de nivel inicial `inicial=1`

Similar a la consulta general (de campa침a masiva), se hace una divisi칩n 
en grupos de registros con existencia del dato de DNI y sin existencia 
del mismo. 
Esto para evitar que a una persona le llegue el mismo mail m치s de una 
vez (aunque se deber칤a verificar que en t칠rminos de env칤o, da lo mismo
enviar un mail con `CC` o enviar dos mails distintos o bien, enviar
un mail con una *"bolsa"* de mails en `CCO`):

::: {.callout-note}
Por ejemplo, se deber칤an evaluar las distintas opciones en el env칤o
de mails:

Opci칩n 1 (la actual):

suponiendo que `mail1@dom.com` y `mail2@dom.com` pertenecen a la misma
persona, en un mismo env칤o:

* TO: `mail1@dom.com`
* CC: `mail2@dom.com`

Opci칩n 2 (una cuenta, un mail):

Esta es la opci칩n que se ajusta al esquema de la BD de cuentas

* env칤o 1 -> TO: `mail1@dom.com`
* env칤o 2 -> TO: `mail2@dom.com`

Esta opci칩n pareciera ser la menos eficiente, aunque si la opci칩n 1
por detr치s resuelve de esta manera, entonces es lo mismo.

Opci칩n 3 (CCO como "bolsa" de mails):

Esta opci칩n es la que se usa generalmente para campa침as de *marketing*
pero siguiendo determinadas "buenas pr치cticas" u otros servicios.
En este caso ya no se tiene un mail por *persona*, la idea es enviar
un mail a una "*bolsa*" de cuentas.

* TO:
* CCO: `mail1@dom.com`, `mail2@dom.com`, `mail3@dom.com`, 
`mail4@dom.com`, . . . 


**Todo esto est치 sujeto a an치lisis e investigaci칩n游댍.**

:::

```sql

-- GRUPO 1
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
  AND mas.fuente like "%sup%" AND mas.inicial=1
GROUP BY mas.dni

UNION

-- GRUPO 2
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si" AND
  mas.fuente like "%sup%" AND mas.inicial=1
```

### Directores de escuelas de niveles Inicial

En este caso se filtran registros que:

* provienen de la fuente `dir`
* y que sean de nivel inicial `inicial=1`


```sql

-- GRUPO 1
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
  AND mas.fuente like "%dir%" AND mas.inicial=1
GROUP BY mas.dni

UNION

-- GRUPO 2
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si" AND
  mas.fuente like "%dir%" AND mas.inicial=1
```

### Inspectores generales y supervisores de nivel Primario

Similar a la versi칩n de nivel inicial pero ahora filtrando por nivel
primario `primaria=1`


```sql

-- GRUPO 1
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
  AND mas.fuente like "%sup%" AND mas.primaria=1
GROUP BY mas.dni

UNION

-- GRUPO 2
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si" AND
  mas.fuente like "%sup%" AND mas.primaria=1
```

### Directores de escuelas de niveles Primario

Similar a la versi칩n de nivel inicial pero ahora filtrando por nivel
primario `primaria=1`

```sql

-- GRUPO 1
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
  AND mas.fuente like "%dir%" AND mas.primaria=1
GROUP BY mas.dni

UNION

-- GRUPO 2
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si" AND
  mas.fuente like "%dir%" AND mas.primaria=1
```

### Inspectores generales y supervisores de nivel Secundario

Similar a las versiones anteriores pero ahora filtrando por nivel
secundario `secundaria=1`


```sql

-- GRUPO 1
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
  AND mas.fuente like "%sup%" AND mas.secundaria=1
GROUP BY mas.dni

UNION

-- GRUPO 2
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si" AND
  mas.fuente like "%sup%" AND mas.secundaria=1
```

### Directores de escuelas de niveles Secundario

Similar a las versiones anteriores pero ahora filtrando por nivel
secundario `secundaria=1`

```sql

-- GRUPO 1
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
  AND mas.fuente like "%dir%" AND mas.secundaria=1
GROUP BY mas.dni

UNION

-- GRUPO 2
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si" AND
  mas.fuente like "%dir%" AND mas.secundaria=1
```

### Inspectores generales y supervisores de nivel Superior

Similar a las versiones anteriores pero ahora filtrando por nivel
superior `superior=1`

```sql

-- GRUPO 1
SELECT mas.dni,
	mas.nombre, mas.apellido,
	max(if(mas.cuenta_institucional=1,mas.email,NULL)) as email_gapp,
  	max(if(mas.cuenta_institucional=0,mas.email,NULL)) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NOT NULL and mas.suscripcion="si"
  AND mas.fuente like "%sup%" AND mas.superior=1
GROUP BY mas.dni

UNION

-- GRUPO 2
SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.dni IS NULL and mas.suscripcion="si" AND
  mas.fuente like "%sup%" AND mas.superior=1
```

### IFD p칰blicos de toda la provincia (se pueden segregar por departamento, ciudad y carreras que dictan)

Cabe destacar que para este conjunto de cuentas no se cuenta con los
mismos atributos que para cuentas asociadas a *"personas"*: `dni`, `nombre`,
`apellido`, `email_gapp`. El autor va a replicar los campos de la consulta
general hasta que se defina qu칠 campos van a llevar estos grupos.

```sql

SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.fuente like "%ifd%" and  mas.ifd_gest_estatal=1;
```

### IFD privados de toda la provincia (se pueden segregar por departamento, ciudad y carreras que dictan)


```sql

SELECT mas.dni,
	mas.nombre, mas.apellido,
	if(mas.cuenta_institucional=1,mas.email,NULL) as email_gapp,
  	if(mas.cuenta_institucional=0,mas.email,NULL) as email1,
    '' as email2, NULL as p_idpersona, NULL as c_idmatriculacion
FROM campanias_cuentas_masiva as mas
WHERE mas.fuente like "%ifd%" and  mas.ifd_gest_privada=1;
```